{% extends "base.html" %}
{% block content %}
<div class="container-fluid px-4">
    <h4 class="text-center mb-4" style="color: var(--pp-blue-dark); font-weight: 700;">Review Payment Details</h4>
    <p class="text-center text-muted mb-4">Please verify your information before final confirmation.</p>

    <form method="POST">
        <div class="row">
            <div class="col-lg-7">
                <div class="container shadow-sm mb-4">
                    <h5 class="mb-4" style="color: var(--pp-blue-dark); font-weight: 700;">
                        <i class="fa fa-user mr-2"></i>Customer Information
                    </h5>

                    <div class="row mb-2">
                        <div class="col-sm-4 text-muted small uppercase font-weight-bold">Name</div>
                        <div class="col-sm-8 font-weight-bold">{{ session.get('bill_to_forename') }} {{
                            session.get('bill_to_surname') }}</div>
                    </div>
                    <div class="row mb-2">
                        <div class="col-sm-4 text-muted small uppercase font-weight-bold">Email</div>
                        <div class="col-sm-8">{{ session.get('bill_to_email') }}</div>
                    </div>
                    <div class="row mb-2">
                        <div class="col-sm-4 text-muted small uppercase font-weight-bold">Phone</div>
                        <div class="col-sm-8">{{ session.get('bill_to_phone') }}</div>
                    </div>
                    <hr>
                    <div class="row mb-2">
                        <div class="col-sm-4 text-muted small uppercase font-weight-bold">Billing Address</div>
                        <div class="col-sm-8">
                            {{ session.get('bill_to_address_line1') }}<br>
                            {{ session.get('bill_to_address_city') }}, {{ session.get('bill_to_address_country') }} {{
                            session.get('bill_to_address_postal_code') }}
                        </div>
                    </div>
                </div>

                <div class="container shadow-sm bg-light border-0">
                    <h6 class="text-muted mb-3 font-weight-bold small uppercase">Technical Reference</h6>
                    <div class="row">
                        <div class="col-sm-4 text-muted small">Transaction UUID</div>
                        <div class="col-sm-8 small font-italic">{{ session.get('transaction_uuid') }}</div>
                    </div>
                    <div class="row mt-1">
                        <div class="col-sm-4 text-muted small">Locale / Type</div>
                        <div class="col-sm-8 small">{{ session.get('locale') }} / {{ session.get('transaction_type') }}
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-lg-5">
                <div class="container shadow-sm h-100 d-flex flex-column">
                    <h5 class="mb-4" style="color: var(--pp-blue-dark); font-weight: 700;">
                        <i class="fa fa-shopping-bag mr-2"></i>Order Summary
                    </h5>

                    <div class="bg-light p-3 rounded mb-4 border">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <span class="font-weight-bold">Payment Method</span>
                            <span><i class="fa fa-cc-visa text-primary fa-2x"></i></span>
                        </div>
                        <div class="row small mb-1">
                            <div class="col-6 text-muted">Card Number</div>
                            <div class="col-6 text-right font-weight-bold">{{ session.get('card_number') }}</div>
                        </div>
                        <div class="row small mb-1">
                            <div class="col-6 text-muted">Expiry / CVV</div>
                            <div class="col-6 text-right font-weight-bold">{{ session.get('card_expiry_date') }} / ***
                            </div>
                        </div>
                        {% if session.get('payment_token') %}
                        <div class="row small mt-2 pt-2 border-top">
                            <div class="col-6 text-muted">Token ID</div>
                            <div class="col-6 text-right text-truncate small">{{ session.get('payment_token') }}</div>
                        </div>
                        {% endif %}
                    </div>

                    <div class="mt-auto">
                        <div class="d-flex justify-content-between align-items-center mb-4">
                            <span class="h5 font-weight-bold">Total Amount</span>
                            <span class="h4 font-weight-bold" style="color: var(--pp-blue-dark);">
                                {{ session.get('currency') }} ${{ session.get('amount') }}
                            </span>
                        </div>

                        <button type="submit" class="btn btn-primary btn-block py-3 font-weight-bold shadow-sm">
                            Confirm and Pay
                        </button>

                        <div id="google-pay" class="mt-3" style="width: 100%; height: 45px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </form>
</div>

<style>
    /* Design Consistency Overrides */
    .uppercase {
        text-transform: uppercase;
        letter-spacing: 0.05em;
    }

    .text-navy {
        color: #000080;
    }

    .bg-light {
        background-color: #f8f9fa !important;
    }

    .btn-primary {
        border-radius: 50px !important;
    }

    /* Pill style */
</style>

<script src="/static/SOAPGooglePay.js"></script>
<script async src="https://pay.google.com/gp/p/js/pay.js" onload="onGooglePayLoaded()"></script>
{% endblock %}